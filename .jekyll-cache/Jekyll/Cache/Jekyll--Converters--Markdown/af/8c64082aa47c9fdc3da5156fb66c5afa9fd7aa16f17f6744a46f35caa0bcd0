I"%<p>ä¸€å€‹æ‡¶äººè…³æœ¬ï¼Œå¾ˆå¤šæ™‚å€™åœ¨Terminalè£¡é¢ç›´æ¥åŸ·è¡Œé€™å€‹ç¨‹å¼æ¯”èµ·é–‹ç¶²é ç™»å…¥é‚„è¦å¿«. 
ä¸­é–“çœä¸‹çš„æ™‚é–“å¯ä»¥åšåˆ¥çš„äº‹ğŸ˜†. 
å®ƒæœƒç™»å…¥<a href="https://mis.cc.ntu.edu.tw/pay/Default.aspx">é€™å€‹ç¶²ç«™</a>ï¼Œç„¶å¾Œå–å¾—ä½ è–ªè³‡æ¬„çš„æœ€å¾Œä¸€ä½ä¸¦é¡¯ç¤ºåˆ°å¸³æ—¥æœŸ. 
å¦‚æœä»Šå¹´éƒ½é‚„æ²’æœ‰è–ªè³‡å…¥å¸³ï¼Œå°±ä¸æœƒé¡¯ç¤ºå»å¹´çš„æœ€å¾Œä¸€æ¢(ç›®å‰æ²’æ‰“ç®—ä¿®æ­£é€™å€‹å°bug). 
è¨˜å¾—è¦è£å¥½<code class="highlighter-rouge">selenium</code>é‚„æœ‰å»æŠ“Chromeç¬¦åˆä½ ç€è¦½å™¨ç‰ˆæœ¬çš„`webdriver.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">selenium</span> <span class="kn">import</span> <span class="n">webdriver</span>
<span class="kn">from</span> <span class="nn">selenium.webdriver.common.keys</span> <span class="kn">import</span> <span class="n">Keys</span>
<span class="kn">from</span> <span class="nn">selenium.webdriver.chrome.options</span> <span class="kn">import</span> <span class="n">Options</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">datetime</span>
<span class="n">month</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">localtime</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">())</span><span class="o">.</span><span class="n">tm_mon</span>
<span class="n">today</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">date</span><span class="p">()</span>

<span class="n">chrome_options</span> <span class="o">=</span> <span class="n">Options</span><span class="p">()</span>  
<span class="n">chrome_options</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s">"--headless"</span><span class="p">)</span>  
<span class="c1">#ä½¿ç”¨chromeçš„webdriver
</span><span class="n">browser</span> <span class="o">=</span> <span class="n">webdriver</span><span class="o">.</span><span class="n">Chrome</span><span class="p">(</span> <span class="n">options</span><span class="o">=</span><span class="n">chrome_options</span><span class="p">)</span>
<span class="c1">#é–‹å•Ÿgoogleé¦–é 
</span><span class="n">browser</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">'https://info2.ntu.edu.tw/pay/Default.aspx'</span><span class="p">)</span>
<span class="c1">#å¦‚æœéœ€è¦åŸ·è¡Œå®Œè‡ªå‹•é—œé–‰ï¼Œå°±è¦åŠ ä¸Šä¸‹é¢é€™ä¸€è¡Œ
</span><span class="n">browser</span><span class="o">.</span><span class="n">find_element_by_id</span><span class="p">(</span><span class="s">'ButtonSSO'</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
<span class="n">browser</span><span class="o">.</span><span class="n">find_element_by_name</span><span class="p">(</span><span class="s">'user'</span><span class="p">)</span><span class="o">.</span><span class="n">send_keys</span><span class="p">(</span><span class="s">''</span><span class="p">)</span> <span class="c1">#è¼¸å…¥ä½ çš„å¸³è™Ÿ
</span><span class="n">browser</span><span class="o">.</span><span class="n">find_element_by_name</span><span class="p">(</span><span class="s">'pass'</span><span class="p">)</span><span class="o">.</span><span class="n">send_keys</span><span class="p">(</span><span class="s">''</span><span class="p">)</span> <span class="c1">#è¼¸å…¥ä½ çš„å¯†ç¢¼
</span><span class="n">browser</span><span class="o">.</span><span class="n">find_element_by_name</span><span class="p">(</span><span class="s">'Submit'</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
<span class="n">element_array</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">amount_array</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">month</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">100</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
      <span class="n">element</span> <span class="o">=</span> <span class="n">browser</span><span class="o">.</span><span class="n">find_element_by_xpath</span><span class="p">(</span><span class="s">'/html/body/form/div[7]/div/div/table/tbody/tr[</span><span class="si">%</span><span class="s">d]/td[2]'</span> <span class="o">%</span><span class="p">(</span><span class="n">month</span><span class="p">))</span><span class="o">.</span><span class="n">text</span>
      <span class="n">amount</span> <span class="o">=</span> <span class="n">browser</span><span class="o">.</span><span class="n">find_element_by_xpath</span><span class="p">(</span><span class="s">'/html/body/form/div[7]/div/div/table/tbody/tr[</span><span class="si">%</span><span class="s">d]/td[4]'</span> <span class="o">%</span><span class="p">(</span><span class="n">month</span><span class="p">))</span><span class="o">.</span><span class="n">text</span>
      <span class="n">element_array</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">element</span><span class="p">)</span>
      <span class="n">amount_array</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">amount</span><span class="p">)</span>
    <span class="k">except</span><span class="p">:</span>
      <span class="k">break</span>

<span class="k">try</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"æœ€å¾Œç™¼è–ªæ—¥ï¼š"</span><span class="o">+</span><span class="n">element_array</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span><span class="o">+</span><span class="s">"</span><span class="se">\n</span><span class="s">æ‰€å¾—ï¼š"</span><span class="o">+</span><span class="n">amount_array</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">])</span>
<span class="k">except</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"ç›®å‰ç„¡è³‡æ–™(è·¨å¹´åº¦)"</span><span class="p">)</span>

<span class="n">browser</span><span class="o">.</span><span class="n">quit</span><span class="p">()</span>

</code></pre></div></div>

:ET